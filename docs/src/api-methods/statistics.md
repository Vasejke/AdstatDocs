# Работа со статистикой

## Метод получения статистики
:::info
_POST_ `report/tgview`

Пример использования:
```http request
https://client.adstat.pro/api/report/tgview
```

__Параметры:__

В заголовках HTTP запроса необходимо передать `<access_token>` в формате:
+ `Authorization: "Bearer <access_token>" `

В тело(`body`) HTTP запроса необходимо передать параметры получения статистики.

Описание параметров передаваемых в тело запроса:

| Поле           | Тип         | Описание                                                                                                                                                                                                                                                                                                                                                               |
|----------------|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| date           | Объект      | Интервал дат, определяющий временной период запроса.                                                                                                                                                                                                                                                                                                                   |
| date.date_from | Строка      | Начальная дата и время в формате ISO 8601 (например, "2024-06-07T00:00:00.000Z").                                                                                                                                                                                                                                                                                      |
| date.date_to   | Строка      | Конечная дата и время в формате ISO 8601 (например, "2024-06-07T23:59:59.000Z").                                                                                                                                                                                                                                                                                       |
| platform       | Массив чисел| Статичное значение равное всегда `[10]`.                                                                                                                                                                                                                                                                                                                               |
| partner        | Массив чисел| Статичное значение равное всегда `[2]`.                                                                                                                                                                                                                                                                                                                                |
| campaign       | Массив      | Список идентификаторов кампаний. Может быть пустым массивом, если нужно получить данные по всем кампаний.                                                                                                                                                                                                                                                              |
| group_time     | Число       | Параметр группировки по времени. Значения:<br/> День- `1`,<br/> Месяц - `2`, <br/>Неделя - `3`, <br/>Год - `4`.                                                                                                                                                                                                                                                        |
| groupings      | Массив объектов | Список объектов группировки данных. Каждый объект определяет параметр группировки.                                                                                                                                                                                                                                                                                     |
| groupings.name | Строка      | Имя параметра для группировки (например, `"date"`, `"object"` итд ).                                                                                                                                                                                                                                                                                                   |
| groupings.type | Число       | Тип группировки для параметра. Используется только для некоторых группировок (например, `1`).                                                                                                                                                                                                                                                                          |
| object         | Массив      | Список идентификаторов объектов рекламирования для плучения статистики по выбранным объектам. `["t.me/someobject", "..."]`. Если нужно получить по всем объектам, то значение - `[]`. <br/>Список объектов рекламирования можно получить в [Метод получения объектов рекламирования](#objects)                                                                         |
| sub_client     | Массив      | Внутренний параметр для технических нужд.                                                                                                                                                                                                                                                                                                                              |
| type_cab       | null        | Тип кабинета. Статичное значение - всегда `null`.                                                                                                                                                                                                                                                                                                                      |
| currency       | Строка      | Валюта, в которой будут представлены данные. Статичное значение - всегда `RUB`                                                                                                                                                                                                                                                                                         |
| account_uids   | Массив      | Список идентификаторов кабинетов, предназначенный для фильтрации статистики по отдельным кабинетам.Может быть пустым массивом `[]`, если нужно получить данные по всем кабинетам. Если по отдельным кабинетам - `["ACC0000", "..."]`. <br/>Список содержащий `account_uids` кабинетов можно получить в [Методе получения кабинетов](/api-methods/balances.md#cabinets) |

Подробное описание и примеры использования параметров в теле запроса:

`groupings` :

+ Значение, когда необходимо получить статистику сгруппированную только по дате:
```json
{
  "others_params": "others params",
  "groupings":[{"name":"date","type": "<group_time>"}],
  "..": "others params"
}
```
+ Значение, когда необходимо получить статистику сгрупированную по -

`Объекту рекламирования` - `{"name": "object"}`,

`По объявлению` - `{"name": "campaign"}`,

`По кабинету` - `{"name": "account", "type": 1}`


```json
{
  "others_params": "others params",
  "groupings":[{"name": "object"}, {"name": "campaign"}, {"name": "account", "type": 1}, {"name": "date", "type": "<group_time>"}],
  "..": "others params"
}
```


Пример тела запроса:

```json
{
  "date": {
    "date_from": "2024-06-07T00:00:00.000Z",
    "date_to": "2024-06-07T23:59:59.000Z"
  },
  "platform": [
    10
  ],
  "partner": [
    2
  ],
  "campaign": [],
  "group_time": 1,
  "groupings": [
    {
      "name": "date",
      "type": 1
    },
    {
      "name": "partner"
    },
    {
      "name": "platform"
    },
    {
      "name": "sub_client"
    }
  ],
  "object": [],
  "sub_client": [],
  "type_cab": null,
  "currency": "RUB",
  "account_uids": []
}
```


__Пример успешного ответа:__
```json
{
  "results": [
    {
      "date": "2024-06-07",
      "unit": 0,
      "campaign_plat": "string",
      "ad_text": "string",
      "target_topics": [
        "string"
      ],
      "target_channels": [
        "string"
      ],
      "target_langs": [
        "string"
      ],
      "spent": 0,
      "impressions": 0,
      "goals": 0,
      "price_target": 0,
      "cpm": 0,
      "object": "string",
      "account_uid": "string",
      "account_name": "string",
      "target_countries": [
        "string"
      ],
      "target_user_locations": [
        "string"
      ],
      "target_user_channels": [
        "string"
      ],
      "ad_type": "target_channels",
      "ad_id": 0,
      "clicks": 0,
      "cpc": 0,
      "ctr": 0,
      "promote_url": "string",
      "website_name": "string"
    }
  ]
}
```

__Описание параметров успешного ответа:__

| Поле                  | Тип                                                    | Описание                                                    |
|-----------------------|--------------------------------------------------------|-------------------------------------------------------------|
| date                  | Строка                                                 | Дата в формате "YYYY-MM-DD".                                |
| unit                  | Число                                                  | Внутренний параметр для технических нужд.                   |
| campaign_plat         | Строка, содержащая `Unicode escape` последовательность | Наименование объявления.                                    |
| ad_text               | Строка, содержащая `Unicode escape` последовательность | Текст креатива.                                             |
| target_topics         | Массив строк                                           | Список топиков, на которые таргетируется объявление.        |
| target_channels       | Массив строк                                           | Список каналов, на которые таргетируется объявление.        |
| target_langs          | Массив строк                                           | Список языков, на которые таргетируется объявление.         |
| spent                 | Число                                                  | Расходы.                                                    |
| impressions           | Число                                                  | Количество показов объявления.                              |
| goals                 | Число                                                  | Цели.                                                       |
| price_target          | Число                                                  | Цена за цель.                                               |
| cpm                   | Число                                                  | Стоимость тысячи показов (CPM).                             |
| object                | Строка                                                 | Объект рекламирования.                                      |
| account_uid           | Строка                                                 | Уникальный идентификатор аккаунта.                          |
| account_name          | Строка                                                 | Название аккаунта.                                          |
| target_countries      | Массив строк                                           | Список стран, на которые таргетируется объявление.          |
| target_user_locations | Массив строк                                           | Список местоположений, на которые таргетируется объявление. |
| target_user_channels  | Массив строк                                           | Список каналов, на которые таргетируется объявление.        |
| ad_type               | Строка                                                 | Тип объявления. `"target_channels"`, `target_users`.        |
| ad_id                 | Число                                                  | Уникальный идентификатор объявления.                        |
| clicks                | Число                                                  | Клики.                                                      |
| cpc                   | Число                                                  | Стоимость за клик (CPC).                                    |
| ctr                   | Число                                                  | Коэффициент кликабельности (CTR).                           |
| promote_url           | Строка                                                 | Конечный URL рекламируего объекта.                          |
| website_name          | Строка                                                 | Название вебсайта.                                          |

:::


## <span id="objects">Метод получения объектов рекламирования</span>
:::info
_GET_ `report/objects`

Пример использования:
```http request
https://client.adstat.pro/api/report/objects
```

__Параметры:__

В заголовках HTTP запроса необходимо передать `<access_token>` в формате:
+ `Authorization: "Bearer <access_token>" `

__Пример успешного ответа:__
```json
[
  "t.me/object",
  "https://example.ru"
]
```
:::





